{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { Component } from 'react';\nimport * as React from 'react';\nimport { connect } from 'react-redux'; // @ts-ignore\n\nimport { Router } from '@routes';\nexport function Auth(WrappedComponent) {\n  var _dec, _class;\n\n  // @ts-ignore\n  var Index = (_dec = connect(function (state) {\n    return {\n      auth: state.auth.auth,\n      isLogin: state.auth.auth != null\n    };\n  }), _dec(_class = /*#__PURE__*/function (_Component) {\n    _inherits(Index, _Component);\n\n    var _super = _createSuper(Index);\n\n    _createClass(Index, null, [{\n      key: \"getInitialProps\",\n      value: function () {\n        var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(ctx) {\n          var store;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  store = ctx.store.getState();\n\n                  if (store.auth.isLogin) {\n                    _context.next = 7;\n                    break;\n                  }\n\n                  if (!ctx.res) {\n                    _context.next = 5;\n                    break;\n                  }\n\n                  ctx.res.writeHead(302, {\n                    Location: '/login'\n                  });\n                  return _context.abrupt(\"return\", ctx.res.end());\n\n                case 5:\n                  Router.pushRoute('/login');\n                  return _context.abrupt(\"return\");\n\n                case 7:\n                  _context.t0 = WrappedComponent.getInitialProps;\n\n                  if (!_context.t0) {\n                    _context.next = 12;\n                    break;\n                  }\n\n                  _context.next = 11;\n                  return WrappedComponent.getInitialProps(ctx);\n\n                case 11:\n                  _context.t0 = _context.sent;\n\n                case 12:\n                  return _context.abrupt(\"return\", _context.t0);\n\n                case 13:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        function getInitialProps(_x) {\n          return _getInitialProps.apply(this, arguments);\n        }\n\n        return getInitialProps;\n      }()\n    }]);\n\n    function Index(props) {\n      _classCallCheck(this, Index);\n\n      return _super.call(this, props);\n    }\n\n    _createClass(Index, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        if (!this.props.isLogin) {\n          Router.pushRoute('/login');\n        }\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        if (this.props.isLogin) {\n          return __jsx(WrappedComponent, this.props);\n        }\n\n        return null; // return <Login/>\n      }\n    }]);\n\n    return Index;\n  }(Component)) || _class);\n  return Index;\n}\n_c = Auth;\n\nvar _c;\n\n$RefreshReg$(_c, \"Auth\");","map":{"version":3,"sources":["/usr/src/app/Framework/hoc/Auth.tsx"],"names":["Component","React","connect","Router","Auth","WrappedComponent","Index","state","auth","isLogin","ctx","store","getState","res","writeHead","Location","end","pushRoute","getInitialProps","props"],"mappings":";;;;;;;;;;;;;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,OAAT,QAAwB,aAAxB,C,CACA;;AACA,SAASC,MAAT,QAAuB,SAAvB;AAEA,OAAO,SAASC,IAAT,CAAcC,gBAAd,EAAgC;AAAA;;AACvC;AADuC,MAM7BC,KAN6B,WAElCJ,OAAO,CAAC,UAACK,KAAD;AAAA,WAAiB;AACtBC,MAAAA,IAAI,EAAED,KAAK,CAACC,IAAN,CAAWA,IADK;AAEtBC,MAAAA,OAAO,EAAEF,KAAK,CAACC,IAAN,CAAWA,IAAX,IAAmB;AAFN,KAAjB;AAAA,GAAD,CAF2B;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,yGAUFE,GAVE;AAAA;AAAA;AAAA;AAAA;AAAA;AAWrBC,kBAAAA,KAXqB,GAWbD,GAAG,CAACC,KAAJ,CAAUC,QAAV,EAXa;;AAAA,sBAYtBD,KAAK,CAACH,IAAN,CAAWC,OAZW;AAAA;AAAA;AAAA;;AAAA,uBAanBC,GAAG,CAACG,GAbe;AAAA;AAAA;AAAA;;AAcnBH,kBAAAA,GAAG,CAACG,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AAACC,oBAAAA,QAAQ,EAAE;AAAX,mBAAvB;AAdmB,mDAeZL,GAAG,CAACG,GAAJ,CAAQG,GAAR,EAfY;;AAAA;AAiBvBb,kBAAAA,MAAM,CAACc,SAAP,CAAiB,QAAjB;AAjBuB;;AAAA;AAAA,gCAoBpBZ,gBAAgB,CAACa,eApBG;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,yBAoBuBb,gBAAgB,CAACa,eAAjB,CAAiCR,GAAjC,CApBvB;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAuB/B,mBAAYS,KAAZ,EAAmB;AAAA;;AAAA,+BACTA,KADS;AAElB;;AAzB8B;AAAA;AAAA,0CA2BX;AAChB,YAAI,CAAC,KAAKA,KAAL,CAAWV,OAAhB,EAAyB;AACrBN,UAAAA,MAAM,CAACc,SAAP,CAAiB,QAAjB;AACH;AACJ;AA/B8B;AAAA;AAAA,+BAiCtB;AACL,YAAI,KAAKE,KAAL,CAAWV,OAAf,EAAwB;AACpB,iBAAO,MAAC,gBAAD,EAAsB,KAAKU,KAA3B,CAAP;AACH;;AACD,eAAO,IAAP,CAJK,CAKL;AACH;AAvC8B;;AAAA;AAAA,IAMfnB,SANe;AA0CnC,SAAOM,KAAP;AACH;KA3CeF,I","sourcesContent":["import { Component } from 'react';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\n// @ts-ignore\nimport { Router } from '@routes';\n\nexport function Auth(WrappedComponent) {\n// @ts-ignore\n    @connect((state: any) => ({\n        auth: state.auth.auth,\n        isLogin: state.auth.auth != null,\n    }))\n    class Index extends Component<{\n        isLogin: boolean;\n        auth: any;\n    }> {\n        static async getInitialProps(ctx) {\n            const store = ctx.store.getState();\n            if (!store.auth.isLogin) {\n                if (ctx.res) {\n                    ctx.res.writeHead(302, {Location: '/login'});\n                    return ctx.res.end();\n                }\n                Router.pushRoute('/login');\n                return;\n            }\n            return WrappedComponent.getInitialProps && (await WrappedComponent.getInitialProps(ctx));\n        }\n\n        constructor(props) {\n            super(props);\n        }\n\n        componentDidMount() {\n            if (!this.props.isLogin) {\n                Router.pushRoute('/login');\n            }\n        }\n\n        render() {\n            if (this.props.isLogin) {\n                return <WrappedComponent {...this.props} />;\n            }\n            return null;\n            // return <Login/>\n        }\n    }\n\n    return Index;\n}\n"]},"metadata":{},"sourceType":"module"}